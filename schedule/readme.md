## 使用說明

1. 先匯入「人員與廠房的相關設定檔」(必要)。
2. 匯入「先前狀態紀錄」(選擇性)。
3. 點排班就會亂數產生班表。
4. 產生的「本次狀態紀錄」連結，點選可以儲存狀態，供下週排班時使用。
5. 產生的「本次排班紀錄」連結，點選可以儲存狀態，作為人工檢視資料留存，或是給文書軟體使用。

* 如果匯入檔案後，有再臨時編輯過檔案，則需要重新選擇，不然讀不到資料。

## 「人員與廠房的相關設定檔」說明

這檔案必須由使用者產生，可參考「人員與廠房範例」。主要可分為廠房設定與員工設定。敘述如下。

### 廠房設定

* 語法：@廠房名稱\[tab\]起始日期~終止日期-起始時間~終止時間
* 「@」為辨識廠房設定用，不能省略。
* 起始與終止日期，表示工廠在這段時間要人。(前後均包含)
* 起始與終止時間是指相對於每日的00:00，工廠會在哪個時間點運轉(要人)。(前包含，後不包含)

範例：

	@公司本部[tab]2017/05/22~2017/05/28-06:00~30:00

表示每天的6點到隔天的6點公司會要人，所以會從5/22 06:00 要人，最後一班是 5/29 04:00。

如果公司開放時段有變化，可以允許寫成兩段設定，同時有相同的廠房名稱

### 人員設定

* 語法：姓名\[tab\]休假起始時間~休假終止時間\[,休假起始時間~休假終止時間\]...
* 若剛好這段時間都沒休假，可以用none關鍵字
* 若為新進人員，可以在名字前面加星號"*"，如此一來會用目前整體平均值班數作為新人的值班數計算

相關範例可以參考「人員與廠房的相關設定檔2.txt」

## 計算上的說明

考慮到人員休假的彈性，這個程式不是用強制輪完才再排的方式。而是採取不違反員工權益下，排班數最少的一群人會先被排到。因此為了參考之前的狀況，匯入「先前狀態紀錄」是需要的，否則就視為大家都還沒值班的狀況下去排。所以每次排完後的紀錄要記得點選儲存下來。

在其它程式語言中，這可能可以自動完成。但網頁基於安全性的問題，不允許不經使用者的隱性操作，所以狀態的繼承需要一些手動操作。也就是排好後要把文字檔儲存下來供下次計算使用。

在人力吃緊的狀況下，可能出現「找不到有空的員工」的狀況。此時程式會洗掉這次取的亂數，重頭來過。最多重複嘗試1000次。再找不到會跳出對話盒。
